<html>
  <head> 
    <title> Onmyoji Calculator </title>
    <base href = "https://salvist.github.io/OApp/" />
    <link rel="icon" type="image/png" href="seimei.png" />
    
    <script> <!-- Calculation Function JavaScript -->;  
      function cal(data){
        <!-- Data Handler -->;
        let buffH, oBuffH, dmgBuffH, dmgDebuffH, sMulH, atkH, bAtkH, critH, cdmgH, soulH, tDmgH, deathH, bindH;
        if(data == 1) {
          buffH = document.getElementById("buff1").value;
          oBuffH = document.getElementById("oBuff1").checked;
          soulH = document.getElementById("soul1").value;
          deathH = document.getElementById("death1").checked;
          bindH = document.getElementById("bind1").checked;
          sMulH = document.getElementById("skillMultiplier1");
          atkH = document.getElementById("atk1").value;
          bAtkH = document.getElementById("bAtk1").value;
          critH = document.getElementById("critical1").checked;
          cdmgH = document.getElementById("cdmg1").value;
          tDmgH = document.getElementById("totalDamage1").value;
        } else if(data == 2) {
          buffH = document.getElementById("buff2").value;
          oBuffH = document.getElementById("oBuff2").checked;
          soulH = document.getElementById("soul2").value;
          deathH = document.getElementById("death2").checked;
          bindH = document.getElementById("bind2").checked;
          sMulH = document.getElementById("skillMultiplier2");
          atkH = document.getElementById("atk2").value;
          bAtkH = document.getElementById("bAtk2").value;
          critH = document.getElementById("critical2").checked;
          cdmgH = document.getElementById("cdmg2").value;
          tDmgH = document.getElementById("totalDamage2").value;
        }
        var atkBuff = 1.0;
        <!--       none, bunny, kamai, oitsuki      -->;
        var aBuff = [0.0, 0.2, 0.25, 0.2];
        if (oBuffH == "1") atkBuff = atkBuff + aBuff[1];
        if (buffH == "2") atkBuff = atkBuff + aBuff[2];
        if (Boolean(oBuffH) == true) atkBuff = atkBuff + aBuff[3];

        var dmgBuff = 1.0;
        if (buffH == "3") dmgBuff = dmgBuff * 1.3 <!--star-->
        if (soulH == "1") dmgBuff = dmgBuff * 1.4 <!--shadow-->
        
        <!--        none, death, bind, ushi -->;
        var debuff = [0.0, 0.3, 0.4, 0.15];
        var dmgDebuff = 0.0;
        if(Boolean(deathH) == true) dmgDebuff = dmgDebuff + debuff[1];
        if(Boolean(bindH) == true) dmgDebuff = dmgDebuff + debuff[2];
        
        var skillMul = Number(sMulH)/100;
        
        let tAtk = Number(atkH) * atkBuff + Number(bAtkH);
        let def = Number(document.getElementById("defense").value);
        var dmg = tAtk * skillMul * (300 / (300 + def)) * dmgBuff * (1 + dmgDebuff);
        
        var tempdef;
        var dmg1;
        
        
        if(Boolean(critH) == true) dmg = dmg * Number(cdmgH) / 100;
        
        if(soulH == "2"){
          tempdef = def * 45 / 100
          dmg1 = tAtk * skillMul * (300 / (300 + tempdef)) * dmgBuff * (1 + dmgDebuff);
          if(Boolean(critH) == true) dmg1 = dmg1 * Number(cdmgH) / 100;
          tDmgH = dmg.toFixed(2) + " OR " + dmg1.toFixed(2);
        } else {
          tDmgH = dmg.toFixed(2);
        }
      }
    </script>
  </head>
  
  <body>
    <table bgcolor = "00CCFF" width = "100%">
      <tr><th>
        <h1>Onmyoji Application</h1>
      </th></tr>
    </table>
    <hr />
    
    <!-- label on top -->
    <table>
      
      <tr>
        <td>
          Defense: <input type = "number" value = "0" id = "defense" />
        </td>
      </tr>
      
      <tr>
        <td>Attack</td>
        <td>Bonus Attack</td>
        <td>Skill %</td>
        <td>Soul</td> 
        <td>Critial</td>
        <td>Critical<br />Damage</td>
        <td>Atk/Dmg Buff</td>
        <td>Oitsuki<br />Clear Moon</td>
        <td>Death</td>
        <td>Bind</td>
        <td>Total Damage</td>
        <td>Calculate!</td>
      </tr>
      
      <!-- DATA 1 -->
      <form id = "data1">
        <tr>
          <td> <!-- Attack -->
            <input type = "number" value = "0" id = "atk1" />
          </td> 
           <td> <!-- Bonus Attack -->
             <input type = "number" value = "0" id = "bAtk1" />
          </td>
          <td> <!-- Skill Percentage -->
            <input type = "number" value = "100" id = "skillMultiplier1" />
          </td>
          <td> <!-- Soul -->
            <select Id = "soul1">
              <option value = "0" selected> None </option>
              <option value = "1"> Shadow </option>
              <option value = "2"> Claws </option>
              <option value = "3"> Seductress </option>
            </select>
          </td>
          <td> <!-- Critical -->
            <input type = "checkbox" id = "critical1" />
          </td>
          <td> <!-- Critical Damage -->
            <input type = "number" value = "150" id = "cdmg1" />
          </td>
          <td> <!-- Atk/Dmg Buff -->
            <select name = "buff" id = "buff1">
              <option value = "0" selected> None </option>
              <option value = "1"> Bunny Dance  20% Atk </option>
              <option value = "2"> Brotherly Bond 25% Atk </option>
              <option value = "3"> Star  30% Dmg Inc. </option>
            </select>
          </td>
          <td> <!-- Oitsuki Buff -->
            <input type = "checkbox" id = "oBuff1" />
          </td> 
          <td> <!-- Death -->
            <input type = "checkbox" id = "death1" />
          </td>       
          <td> <!-- Bind -->
            <input type = "checkbox" id = "bind1" />
          </td>
          <td> <!-- Total Damage -->
            <input type = "text" id = "totalDamage1" value = "0" disabled />
          </td>
          <td>
            <input type = "submit" />
          </td>
          <td> <!-- Calculate! -->
            <input type = "button" value = "calculate" onclick = "cal("1")"/>
          </td>          
        </tr>
      </form>
      
      <!-- Data 2 -->
      <form id = "data2">
        <tr>
          <td> <!-- Attack -->
            <input type = "number" value = "0" id = "atk2" />
          </td> 
           <td> <!-- Bonus Attack -->
             <input type = "number" value = "0" id = "bAtk2" />
          </td>
          <td> <!-- Skill Percentage -->
            <input type = "number" value = "100" id = "skillMultiplier2" />
          </td>
          <td> <!-- Soul -->
            <select Id = "soul2">
              <option value = "0" selected> None </option>
              <option value = "1"> Shadow </option>
              <option value = "2"> Claws </option>
              <option value = "3"> Seductress </option>
            </select>
          </td>
          <td> <!-- Critical -->
            <input type = "checkbox" id = "critical2" />
          </td>
          <td> <!-- Critical Damage -->
            <input type = "number" value = "150" id = "cdmg2" />
          </td>
          <td> <!-- Atk/Dmg Buff -->
            <select name = "buff" id = "buff2">
              <option value = "0" selected> None </option>
              <option value = "1"> Bunny Dance  20% Atk </option>
              <option value = "2"> Brotherly Bond 25% Atk </option>
              <option value = "3"> Star  30% Dmg Inc. </option>
            </select>
          </td>
          <td> <!-- Oitsuki Buff -->
            <input type = "checkbox" id = "oBuff2" />
          </td> 
          <td> <!-- Death -->
            <input type = "checkbox" id = "death2" />
          </td>       
          <td> <!-- Bind -->
            <input type = "checkbox" id = "bind2" />
          </td>
          <td> <!-- Total Damage -->
            <input type = "text" id = "totalDamage2" value = "0" disabled />
          </td>
          <td>
            <input type = "submit" />
          </td>
          <td> <!-- Calculate! -->
            <input type = "button" value = "calculate" onclick = "cal("2")"/>
          </td>          
        </tr>
      </form>
    </table>
  </body>
  
</html>
